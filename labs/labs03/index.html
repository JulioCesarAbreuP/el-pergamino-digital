<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lab 03 – Análisis de cabeceras HTTP y metadatos</title>
  <link rel="icon" href="/el-pergamino-digital/assets/favicon.png" type="image/png" />
  <style>
    :root { color-scheme: dark; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
    }
    nav {
      background-color: #1f1f1f;
      padding: 1em;
      text-align: center;
    }
    nav a {
      color: #e0e0e0;
      margin: 0 1em;
      text-decoration: none;
    }
    nav a.activo {
      font-weight: bold;
      text-decoration: underline;
    }
    h1 {
      text-align: center;
      margin-top: 1.5em;
      color: #ffffff;
    }
    .subtitulo {
      text-align: center;
      color: #bbbbbb;
      margin-bottom: 2em;
    }
    main {
      max-width: 900px;
      margin: auto;
      padding: 2em;
    }
    section {
      margin-bottom: 2em;
    }
    h2 {
      color: #90caf9;
    }
    code {
      background-color: #1e1e1e;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: monospace;
    }
    footer {
      text-align: center;
      padding: 2em;
      background-color: #1e1e1e;
      font-size: 0.9em;
      color: #aaaaaa;
    }
    @media (max-width: 600px) {
      body { font-size: 1.1em; }
      h1 { font-size: 1.8em; }
      .subtitulo { font-size: 1.1em; }
      nav a { display: block; margin: 0.5em 0; }
    }
  </style>
</head>
<body>
  <nav>
    <a href="/el-pergamino-digital/index.html">Inicio</a>
    <a href="/el-pergamino-digital/labs/" class="activo">Laboratorios</a>
    <a href="/el-pergamino-digital/glosario/">Glosario</a>
    <a href="/el-pergamino-digital/simulador/">Simulador</a>
    <a href="/el-pergamino-digital/modulos/">Módulos</a>
  </nav>

  <h1>Lab 03 – Análisis de cabeceras HTTP y exposición de metadatos</h1>
  <p class="subtitulo">Inspección de encabezados HTTP y metadatos revelados por servidores web</p>

  <main>
    <section>
      <h2>Objetivo</h2>
      <p>Analizar las cabeceras HTTP de servidores web para identificar información sensible, configuraciones inseguras y metadatos que puedan ser utilizados en fases de reconocimiento o explotación.</p>
    </section>

    <section>
      <h2>Alcance y limitaciones</h2>
      <p><strong>Alcance:</strong> Inspección de cabeceras HTTP, detección de metadatos, análisis de configuraciones inseguras.</p>
      <p><strong>Limitaciones:</strong> No se realiza explotación activa. No se modifican configuraciones del servidor. Solo se analiza información pública.</p>
      <p><strong>Máquina vulnerable sugerida:</strong> <a href="https://sourceforge.net/projects/metasploitable/" target="_blank">Metasploitable 2 (descarga oficial)</a></p>
    </section>

    <section>
      <h2>Requisitos previos</h2>
      <ul>
        <li>Conocimientos básicos de HTTP y arquitectura cliente-servidor</li>
        <li>Familiaridad con herramientas de línea de comandos</li>
        <li>curl, wget, whatweb, Nmap, Firefox/Chrome con extensiones de análisis</li>
        <li>Entorno: Kali Linux o Parrot OS, red local o entorno virtualizado</li>
      </ul>
    </section>

    <section>
      <h2>Arquitectura del entorno</h2>
      <pre>[ Kali ] ←→ [ Router ] ←→ [ Metasploitable2 ]</pre>
      <p>Kali Linux (192.168.1.10) – analista<br>Metasploitable2 (192.168.1.20) – servidor web vulnerable<br>Gateway: 192.168.1.1</p>
    </section>

    <section>
      <h2>Herramientas y entorno técnico</h2>
      <ul>
        <li><strong>curl</strong>: inspección de cabeceras HTTP</li>
        <li><strong>whatweb</strong>: fingerprinting de tecnologías web</li>
        <li><strong>Nmap</strong>: escaneo de servicios web y scripts NSE</li>
        <li><strong>Firefox/Chrome</strong>: análisis de cabeceras con DevTools</li>
      </ul>
    </section>

        <section>
      <h2>Procedimiento técnico paso a paso</h2>
      <ol>
        <li>Inspeccionar cabeceras HTTP con curl:
          <pre><code>curl -I http://192.168.1.20</code></pre>
        </li>
        <li>Analizar tecnologías web con whatweb:
          <pre><code>whatweb http://192.168.1.20</code></pre>
        </li>
        <li>Escanear con Nmap usando scripts NSE:
          <pre><code>nmap -p 80 --script http-headers,http-server-header 192.168.1.20</code></pre>
        </li>
        <li>Usar navegador con DevTools (F12) → pestaña \"Red\" → seleccionar petición → ver cabeceras</li>
        <li>Buscar cabeceras sensibles: <code>Server</code>, <code>X-Powered-By</code>, <code>Set-Cookie</code>, <code>Content-Security-Policy</code></li>
        <li>Comparar respuestas entre herramientas para validar consistencia</li>
      </ol>
    </section>

    <section>
      <h2>Resultados esperados</h2>
      <ul>
        <li>Listado de cabeceras HTTP devueltas por el servidor</li>
        <li>Identificación de tecnologías web y versiones</li>
        <li>Detección de posibles fugas de información</li>
      </ul>
    </section>

    <section>
      <h2>Análisis de resultados</h2>
      <p>Se detecta la cabecera <code>Server: Apache/2.2.8 (Ubuntu)</code>, lo que revela el sistema operativo y versión del servidor. La cabecera <code>X-Powered-By: PHP/5.2.4-2ubuntu5.10</code> expone la versión del intérprete PHP, potencialmente vulnerable. No se encuentra cabecera <code>Content-Security-Policy</code>, lo que indica falta de protección contra ataques XSS.</p>
    </section>

    <section>
      <h2>Medidas</h2>
      <ul>
        <li>Eliminar o anonimizar cabeceras sensibles en la configuración del servidor</li>
        <li>Agregar cabeceras de seguridad como <code>Content-Security-Policy</code>, <code>X-Frame-Options</code>, <code>Strict-Transport-Security</code></li>
        <li>Documentar hallazgos y priorizar correcciones</li>
      </ul>
    </section>

    <section>
      <h2>Contramedidas</h2>
      <ul>
        <li>Configurar Apache para ocultar versión:
          <pre><code>ServerTokens Prod
ServerSignature Off</code></pre>
        </li>
        <li>Agregar cabeceras de seguridad en <code>apache2.conf</code> o <code>.htaccess</code></li>
        <li>Actualizar PHP y Apache a versiones soportadas</li>
      </ul>
    </section>

    <section>
      <h2>Riesgos y advertencias</h2>
      <p>Las cabeceras mal configuradas pueden exponer información útil para atacantes. La falta de políticas de seguridad puede facilitar ataques de inyección, clickjacking o robo de cookies. No realizar escaneos en servidores fuera del entorno controlado.</p>
    </section>

    <section>
      <h2>Evidencias</h2>
      <p><em>Espacio reservado para capturas de pantalla de DevTools, salida de curl, whatweb y Nmap.</em></p>
    </section>

    <section>
      <h2>Validación cruzada</h2>
      <ul>
        <li><a href="https://www.cisecurity.org/controls/securely-configure-web-browsers" target="_blank">CIS Control 9.2 – Ensure Only Necessary Features Are Enabled</a></li>
        <li><a href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final" target="_blank">NIST SP 800-53 Rev. 5 – System and Communications Protection</a></li>
        <li><a href="https://attack.mitre.org/techniques/T1592/002/" target="_blank">MITRE ATT&CK T1592.002 – Gather Victim Host Information: Software</a></li>
      </ul>
    </section>


        <section>
      <h2>Procedimiento técnico paso a paso</h2>
      <ol>
        <li>Inspeccionar cabeceras HTTP con curl:
          <pre><code>curl -I http://192.168.1.20</code></pre>
        </li>
        <li>Analizar tecnologías web con whatweb:
          <pre><code>whatweb http://192.168.1.20</code></pre>
        </li>
        <li>Escanear con Nmap usando scripts NSE:
          <pre><code>nmap -p 80 --script http-headers,http-server-header 192.168.1.20</code></pre>
        </li>
        <li>Usar navegador con DevTools (F12) → pestaña \"Red\" → seleccionar petición → ver cabeceras</li>
        <li>Buscar cabeceras sensibles: <code>Server</code>, <code>X-Powered-By</code>, <code>Set-Cookie</code>, <code>Content-Security-Policy</code></li>
        <li>Comparar respuestas entre herramientas para validar consistencia</li>
      </ol>
    </section>

    <section>
      <h2>Resultados esperados</h2>
      <ul>
        <li>Listado de cabeceras HTTP devueltas por el servidor</li>
        <li>Identificación de tecnologías web y versiones</li>
        <li>Detección de posibles fugas de información</li>
      </ul>
    </section>

    <section>
      <h2>Análisis de resultados</h2>
      <p>Se detecta la cabecera <code>Server: Apache/2.2.8 (Ubuntu)</code>, lo que revela el sistema operativo y versión del servidor. La cabecera <code>X-Powered-By: PHP/5.2.4-2ubuntu5.10</code> expone la versión del intérprete PHP, potencialmente vulnerable. No se encuentra cabecera <code>Content-Security-Policy</code>, lo que indica falta de protección contra ataques XSS.</p>
    </section>

    <section>
      <h2>Medidas</h2>
      <ul>
        <li>Eliminar o anonimizar cabeceras sensibles en la configuración del servidor</li>
        <li>Agregar cabeceras de seguridad como <code>Content-Security-Policy</code>, <code>X-Frame-Options</code>, <code>Strict-Transport-Security</code></li>
        <li>Documentar hallazgos y priorizar correcciones</li>
      </ul>
    </section>

    <section>
      <h2>Contramedidas</h2>
      <ul>
        <li>Configurar Apache para ocultar versión:
          <pre><code>ServerTokens Prod
ServerSignature Off</code></pre>
        </li>
        <li>Agregar cabeceras de seguridad en <code>apache2.conf</code> o <code>.htaccess</code></li>
        <li>Actualizar PHP y Apache a versiones soportadas</li>
      </ul>
    </section>

    <section>
      <h2>Riesgos y advertencias</h2>
      <p>Las cabeceras mal configuradas pueden exponer información útil para atacantes. La falta de políticas de seguridad puede facilitar ataques de inyección, clickjacking o robo de cookies. No realizar escaneos en servidores fuera del entorno controlado.</p>
    </section>

    <section>
      <h2>Evidencias</h2>
      <p><em>Espacio reservado para capturas de pantalla de DevTools, salida de curl, whatweb y Nmap.</em></p>
    </section>

    <section>
      <h2>Validación cruzada</h2>
      <ul>
        <li><a href="https://www.cisecurity.org/controls/securely-configure-web-browsers" target="_blank">CIS Control 9.2 – Ensure Only Necessary Features Are Enabled</a></li>
        <li><a href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final" target="_blank">NIST SP 800-53 Rev. 5 – System and Communications Protection</a></li>
        <li><a href="https://attack.mitre.org/techniques/T1592/002/" target="_blank">MITRE ATT&CK T1592.002 – Gather Victim Host Information: Software</a></li>
      </ul>
    </section>
