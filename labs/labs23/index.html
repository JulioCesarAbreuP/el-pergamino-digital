<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lab 23 – Bypass de WAF y evasión avanzada en aplicaciones web</title>

  <style>
    :root { color-scheme: dark; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
    }
    nav {
      background-color: #1f1f1f;
      padding: 1em;
      text-align: center;
    }
    nav a {
      color: #e0e0e0;
      margin: 0 1em;
      text-decoration: none;
    }
    nav a.activo {
      font-weight: bold;
      text-decoration: underline;
    }
    h1 {
      text-align: center;
      margin-top: 1.5em;
      color: #ffffff;
    }
    .subtitulo {
      text-align: center;
      color: #bbbbbb;
      margin-bottom: 2em;
    }
    main {
      max-width: 900px;
      margin: auto;
      padding: 2em;
    }
    section {
      margin-bottom: 2em;
    }
    h2 {
      color: #90caf9;
    }
    code {
      background-color: #1e1e1e;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: monospace;
    }
    footer {
      text-align: center;
      padding: 2em;
      background-color: #1e1e1e;
      font-size: 0.9em;
      color: #aaaaaa;
    }
  </style>
</head>

<body>

<nav>
  <a href="../../index.html">Inicio</a>
  <a href="../index.html">Laboratorios</a>
  <a href="../../glosario.html">Glosario</a>
  <a href="../../simulador.html">Simulador</a>
</nav>

<h1>Lab 23 – Bypass de WAF y evasión avanzada en aplicaciones web</h1>
<p class="subtitulo">
  Manipulación de payloads para evadir firewalls de aplicaciones web y análisis de respuestas
</p>

<main>

<section>
  <h2>Objetivo</h2>
  <p>Identificar y evadir mecanismos de protección implementados por un WAF mediante técnicas de manipulación de payloads.</p>
</section>

<section>
  <h2>Nivel de dificultad</h2>
  <p>Avanzado</p>
</section>

<section>
  <h2>Herramientas utilizadas</h2>
  <ul>
    <li>Burp Suite</li>
    <li>curl</li>
    <li>Wfuzz</li>
    <li>ModSecurity</li>
  </ul>
</section>

<section>
  <h2>Entorno de laboratorio</h2>
  <p>Kali Linux como atacante, servidor web con ModSecurity activo y aplicación vulnerable en red controlada.</p>
</section>

<section>
  <h2>Escenario</h2>
  <p>Evaluación ofensiva de un WAF frente a ataques de inyección y técnicas de evasión.</p>
</section>

<section>
  <h2>Pasos previos</h2>
  <ul>
    <li>Configurar ModSecurity</li>
    <li>Activar OWASP CRS</li>
    <li>Verificar conectividad</li>
    <li>Configurar proxy en Burp Suite</li>
  </ul>
</section>

<section>
  <h2>Desarrollo</h2>
  <pre><code>curl -X GET "http://192.168.1.50/vulnerable.php?id=1' OR '1'='1"</code></pre>
  <pre><code>id=1%27/**/OR/**/%271%27=%271</code></pre>
  <pre><code>wfuzz -u "http://192.168.1.50/vulnerable.php?id=FUZZ" -w payloads.txt</code></pre>
</section>

<section>
  <h2>Resultados esperados</h2>
  <p>Bloqueo de payloads clásicos y aceptación de variantes evasivas.</p>
</section>

<section>
  <h2>Análisis de resultados</h2>
  <p>Las reglas del WAF se basan en patrones; modificar la sintaxis permite evadir la detección.</p>
</section>

<section>
  <h2>Conclusiones</h2>
  <p>Un WAF mejora la seguridad, pero no reemplaza validaciones robustas del lado servidor.</p>
</section>

<section>
  <h2>Medidas</h2>
  <p>Documentar payloads, respuestas HTTP y comportamiento del WAF.</p>
</section>

<section>
  <h2>Contramedidas</h2>
  <ul>
    <li>Actualizar OWASP CRS</li>
    <li>Validación estricta de entradas</li>
    <li>Correlación en SIEM</li>
  </ul>
</section>

<section>
  <h2>Riesgos y advertencias</h2>
  <p>Este laboratorio es exclusivamente educativo y debe ejecutarse en entornos controlados.</p>
</section>

<section>
  <h2>Evidencias</h2>
  <p>Espacio reservado para capturas, logs y respuestas HTTP.</p>
</section>

<section>
  <h2>Validación cruzada</h2>
  <ul>
    <li>MITRE ATT&CK T1562.006</li>
    <li>OWASP CRS</li>
    <li>CIS Control 16</li>
    <li>NIST SP 800-95</li>
  </ul>
</section>

<section>
  <h2>Glosario asociado</h2>
  <p>WAF, Payload, Codificación, Fragmentación, Bypass.</p>
</section>

<section>
  <h2>Preguntas de refuerzo</h2>
  <ul>
    <li>Diferencias entre firewall y WAF</li>
    <li>Riesgos de evasión exitosa</li>
  </ul>
</section>

<section>
  <h2>Rúbrica de evaluación</h2>
  <p>Ejecución correcta, análisis técnico y trazabilidad normativa.</p>
</section>

<section>
  <h2>Recursos complementarios</h2>
  <ul>
    <li>PortSwigger – WAF Bypass</li>
    <li>OWASP – Bypassing WAFs</li>
    <li>ModSecurity</li>
  </ul>
</section>

<section>
  <h2>Créditos y licencia</h2>
  <p>El Pergamino Digital – CC BY-NC-SA 4.0</p>
</section>

<section>
  <h2>Nivel de certificación</h2>
  <p>Alineado con OSWE, eWPTXv2 y Red Team Operator.</p>
</section>

<section>
  <h2>Mapa de integración</h2>
  <p>Continuación directa del Lab 22 y preparación para evasión avanzada en capa 7.</p>
</section>

</main>

<footer>
  © El Pergamino Digital – Laboratorio 23
</footer>

</body>
</html>
